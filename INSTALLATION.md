# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ EG Web –Ω–∞ Ubuntu Linux

## üìã –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°:** Ubuntu 20.04 LTS –∏–ª–∏ –≤—ã—à–µ
- **RAM:** –ú–∏–Ω–∏–º—É–º 1GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 2GB+)
- **–î–∏—Å–∫:** –ú–∏–Ω–∏–º—É–º 2GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä:** x86_64 –∏–ª–∏ ARM64
- **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ –µ–≥–æ:

```bash
# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤ –ø—Ä–æ–µ–∫—Ç–∞
unzip eg-web.zip
cd eg-web

# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x install.sh check-requirements.sh update.sh
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

```bash
sudo ./check-requirements.sh
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
sudo ./install.sh
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç —É –≤–∞—Å:
- **–î–æ–º–µ–Ω** - –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –¥–ª—è —Å–∞–π—Ç–∞ (–∏–ª–∏ localhost)
- **–ü–∞—Ä–æ–ª—å –ë–î** - –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∏–ª–∏ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- **Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** - –¥–ª—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä** - nginx (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ apache

### –®–∞–≥ 4: –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- `http://–≤–∞—à-–¥–æ–º–µ–Ω` (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–æ–º–µ–Ω)
- `http://IP-–∞–¥—Ä–µ—Å-—Å–µ—Ä–≤–µ—Ä–∞` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω localhost)

## üì¶ –ß—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- ‚úÖ PHP 8.3 —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏
- ‚úÖ Composer (–º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π PHP)
- ‚úÖ Node.js 20.x –∏ npm
- ‚úÖ MySQL 8.0
- ‚úÖ Nginx –∏–ª–∏ Apache (–Ω–∞ –≤—ã–±–æ—Ä)
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–æ–º–µ–Ω)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PHP:
- Memory limit: 512MB
- Upload max filesize: 64M
- Post max size: 64M
- Max execution time: 300s
- Opcache –≤–∫–ª—é—á–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ `/var/www/eg-web`
- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (Composer + npm)
- ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–±—Ä–∞–Ω –¥–ª—è production
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ Cron –∑–∞–¥–∞—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

## üîß –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —à–∞–≥–∏ –≤—Ä—É—á–Ω—É—é:

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo apt-get update
sudo apt-get upgrade -y
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PHP
```bash
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install -y php8.3 php8.3-fpm php8.3-cli php8.3-mysql php8.3-xml php8.3-mbstring php8.3-curl php8.3-zip php8.3-gd
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Composer
```bash
curl -sS https://getcomposer.org/installer | php
sudo mv composer.phar /usr/local/bin/composer
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js
```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs
```

### 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MySQL
```bash
sudo apt-get install -y mysql-server
sudo mysql_secure_installation
```

### 6. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
```bash
sudo apt-get install -y nginx
```

### 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
sudo cp -r . /var/www/eg-web
cd /var/www/eg-web

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo -u www-data composer install --no-dev --optimize-autoloader
sudo -u www-data npm ci --production
sudo -u www-data npm run build

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
php artisan key:generate

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ .env
nano .env  # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ DB_* –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

# –ú–∏–≥—Ä–∞—Ü–∏–∏
php artisan migrate --force

# –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo chown -R www-data:www-data /var/www/eg-web
sudo chmod -R 755 /var/www/eg-web
sudo chmod -R 775 storage bootstrap/cache
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
sudo ./update.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ë–î –∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç –∫–æ–¥ –∏–∑ Git (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –û—á–∏—Å—Ç–∏—Ç –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç –∫–µ—à
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å—ã

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
/var/www/eg-web/          # –û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ app/                  # –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ config/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ database/             # –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥–µ—Ä—ã
‚îú‚îÄ‚îÄ public/               # –ü—É–±–ª–∏—á–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (web root)
‚îú‚îÄ‚îÄ resources/            # –†–µ—Å—É—Ä—Å—ã (Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Å—Ç–∏–ª–∏)
‚îú‚îÄ‚îÄ routes/               # –ú–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ storage/              # –•—Ä–∞–Ω–∏–ª–∏—â–µ (–ª–æ–≥–∏, –∫–µ—à, –∑–∞–≥—Ä—É–∑–∫–∏)
‚îî‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

/etc/nginx/sites-available/eg-web  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
/etc/systemd/system/eg-web.service # Systemd service
/var/log/eg-web-install.log         # –õ–æ–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
/var/backups/eg-web/                # –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall:**
```bash
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw allow 443/tcp  # HTTPS
sudo ufw enable
```

2. **–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å root MySQL:**
```bash
sudo mysql
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '–Ω–æ–≤—ã–π_–ø–∞—Ä–æ–ª—å';
FLUSH PRIVILEGES;
```

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:**
–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
0 2 * * * /path/to/backup-script.sh
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```bash
sudo chown -R www-data:www-data /var/www/eg-web
sudo chmod -R 755 /var/www/eg-web
sudo chmod -R 775 /var/www/eg-web/storage
```

### –ü—Ä–æ–±–ª–µ–º–∞: PHP –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
sudo systemctl status php8.3-fpm
sudo systemctl restart php8.3-fpm
```

### –ü—Ä–æ–±–ª–µ–º–∞: Nginx –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
sudo nginx -t  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl status nginx
sudo systemctl restart nginx
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
sudo mysql -u root -p
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SHOW DATABASES;
SELECT User, Host FROM mysql.user;
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –õ–æ–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
tail -f /var/log/eg-web-install.log

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tail -f /var/www/eg-web/storage/logs/laravel.log

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/error.log

# –õ–æ–≥–∏ PHP-FPM
tail -f /var/log/php8.3-fpm.log
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏: `/var/log/eg-web-install.log`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `storage/logs/laravel.log`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã:
   ```bash
   sudo systemctl status php8.3-fpm
   sudo systemctl status nginx
   sudo systemctl status mysql
   ```

## üîÑ –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î
mysql -u root -p DB_NAME < /var/backups/eg-web/db_YYYYMMDD_HHMMSS.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
cd /var/www/eg-web
tar -xzf /var/backups/eg-web/files_YYYYMMDD_HHMMSS.tar.gz
```

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
```bash
sudo timedatectl set-timezone Europe/Moscow
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª–∏
```bash
sudo locale-gen ru_RU.UTF-8
sudo update-locale LANG=ru_RU.UTF-8
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è MySQL
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `/etc/mysql/mysql.conf.d/mysqld.cnf` –¥–ª—è –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞.

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–æ–º–µ–Ω)
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] Cron –∑–∞–¥–∞—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ü–∞—Ä–æ–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ
